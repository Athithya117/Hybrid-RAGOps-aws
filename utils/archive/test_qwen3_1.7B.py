from transformers import AutoModelForCausalLM, AutoTokenizer
model_name = "Qwen/Qwen3-1.7B"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype="auto", device_map="auto" )

prompt = """
{  
  "System prompt": "You are a helpful knowledge assistant who answers queries very concise and clear"
  "query": "In late September 2025, a Falcon 9 is scheduled to depart Kennedy Space Center carrying a set of payloads all bound for the Sun–Earth L1 region. Instead of focusing on the rocket or the date, identify the three distinct scientific and operational projects that are traveling together on this single co-manifested flight.",
  "sources": [
    {"ref": "turn0search0", "title": "NASA - NASA Sets Launch Coverage for Space Weather Missions (press release)"},
    {"ref": "turn0search1", "title": "NOAA / NESDIS - SWFO-L1 Press Kit"},
    {"ref": "turn0search2", "title": "NASA Science / IMAP blog - IMAP rideshares encapsulate, Flight Readiness Review"},
    {"ref": "turn0search6", "title": "NASA Science - IMAP mission page (mission facts and launch NET)"},
    {"ref": "turn0search7", "title": "SpaceX - IMAP launch listing"}
  ],
  "chunks": [
    {
      "id": 1,
      "text": "COLLECTED SCRAPES / SLIDE OCR — distractor #1\n\nFragmented header / slide footers / twitter echoes stitched together. Page top: \"L1 RIDESHARE EVENT — SEPT 2025 — FALCON 9\" (but the slide footer repeats with a different timezone). Mixed-in lines: \"IMAP / CARRUTHERS / SWFO-L1\" appear as a truncated table of contents. Then a long run-on paragraph that looks like an operations summary but with repeated OCR errors and bracketed notes: \"Mission manifest: IMAP (Interstellar Mapping & Acceleration Probe), Carruthers (geocorona imager) and SWFO-L1 (Space Weather Follow On - L1) are co-manifested on a single launch vehicle (Falcon9) from Kennedy (KSC) — NET WED SEP 23 2025 07:32 EDT [VERIFY].\"  Immediately following that is a stray line in another language: \"Lancement prévu: 23 sept. 2025\" then two broken UL lists, e.g., \"<ul><li>IMAP</li><li>Carruthers</li>\" with missing closing tags.  \n\nA long chunk of social quotes follows ('tweet quote'): \"Three missions to L1 — big day for heliophysics and space weather #IMAP #SWFO\" but the handle names are removed and some unicode characters are garbled. There is a repeated paragraph that seems to be a pressroom summary but with different date formats: \"NET Sept 23, 2025\" (then later) \"NET 23 Sep 2025 UTC\" (later) \"window: 7:32 a.m. EDT\" followed by a spurious time in parenthesis (\"(11:32 UTC)\").  \n\nEmbedded JSON-like fragment (corrupted): {\"missions\":[\"IMAP\",\"Carruthers\",\"SWFO-L1\"], \"launch\":\"2025-09-23T07:32:00-04:00\" , \"pad\": \"LC-39A\"} (notice missing quotes and an extra comma in places).  \n\nThe chunk then includes a bibliography-like footnote list where sources are truncated: \"See NASA release (press kit) — SWFO-L1 press kit — IMAP blog entry\" with a PDF stamp that reads: \"CONFIDENTIAL DRAFT\" (which is likely an OCR error from a publicly posted slide). The chunk ends with a repeated line: \"rideshare / co-manifest / Falcon 9 / L1\" intended to pollute lexical overlap with canonical text."
    },
    {
      "id": 2,
      "text": "FORUM + NEWSWIRE MASHUP — distractor #2\n\nThis long block is a mashup of forum posts, paraphrased newswire copy, and a 'quick facts' panel smashed together. It opens with a paraphrase of a launch preview: \"Three spacecraft — one Falcon — transiting to L1 for continuous solar-wind monitoring and heliospheric mapping.\" Immediately after, the text switches to a long, broken transcript of an interview where the interviewee stumbles over names: \"It's IMAP — um, the interstellar mapper — and there's Carruthers, which does geocorona UV imaging, and there is the SWFO platform — or SWFO-L1 — for space weather...\" The transcript contains parenthetical corrections and strikeouts, e.g., \"Carruthers (Geocorona) [sic]\" and repeated content to simulate duplication errors.\n\nThere is a long table fragment with columns 'Mission | Agency | Objective' but many cells are truncated or overlap, e.g., \"IMAP | NASA | map heliospheric parti...\" then \"SWFO | NOAA | operational upstream solar-...\". A blog-style paragraph speculates about programmatic benefits and cost-sharing: \"co-manifest saves $; agencies coordinate data streams for forecasts\" and then a long list of instrument acronyms that are not relevant to canonical name matching (useful as distractor noise).  \n\nThe block then contains an inaccurate but plausible alternate phrasing repeated many times: \"IMAP + a geocorona observatory + NOAA's L1 satellite\" — careful, this is semantically close but not the exact canonical list format. Finally, a broken URL and a stray 'watch live' schedule snippet is appended with conflicting timezone notes to make exact date/time retrieval slightly harder: \"Coverage begins 6:40 a.m. (NASA+)\" then again as \"06:40 EDT\" and a stray 'refID: a12b'."
    },
    {
      "id": 3,
      "text": "AGENCY BULLETIN EXCERPT (OCR + PARAPHRASE) — distractor #3\n\nThis chunk reads like a pressroom PDF converted with OCR and lightly paraphrased. It contains multiple header/footer repetitions and a block of mission descriptions that are accurate but not presented in the single canonical line form. Example long paragraph: \"NASA and NOAA will fly three complementary spacecraft to L1: a heliosphere-mapping probe to study energetic particles and interstellar neutrals, a geocoronal imager to trace hydrogen in the exosphere, and an operational platform to provide continuous solar-wind measurements and coronagraph data. The payloads are manifest for a Falcon 9 launch from Kennedy Space Center's LC-39A with a target no earlier than late September 2025 (agency calendars list Sept. 23 as the target).\"  \n\nThere are repeated lists of acronyms and instrument packages, an embedded image caption without the image, and a long footnote that references instrument teams at SwRI and other labs. The chunk includes typographical artifacts: \"Carruthers Geocorona Observatory\" appears once but in other lines it's shortened to \"Carruthers (Geocorona)\" or simply \"Carruthers Observatory\" — a deliberate variability to confuse surface-match retrieval.  \n\nAn extended quoted passage includes a paraphrased launch-time string and media instructions. This chunk is dense with domain-specific terms (heliosphere, coronagraph, L1, solar-wind) but does not present the canonical list as a single exact line — good distractor material."
    },
    {
      "id": 4,
      "text": "TECHNOTE + SLIDE TRANSCRIPT — distractor #4\n\nLong technote voice that alternates between bullet lists and narrative paragraphs (run-on) intended to mimic an engineering summary. It opens with a recap of launch vehicle integration: \"Payloads underwent encapsulation, tilt tests, and the Falcon 9 fairing mate sequence at LC-39A; payload processing center transfers occurred Sept 18–19, 2025.\" A long technical paragraph then enumerates scientific priorities and data products for each payload but with different names swapped in: \"the heliophysics payload (IMAP) carries particle instruments; the geocorona imager (sometimes called Carruthers or 'Geocoronal Observatory') will image the exosphere; and the operational L1 asset (variously referenced as SWFO-L1 or 'NOAA SWFO') will host coronagraph and solar-wind sensors.\"  \n\nThere are inline bracketed editorial marks, e.g., \"[note: SWFO-L1 name used by NOAA]\" and a long list of mission ops acronyms that pad the chunk. A portion of the slide transcript is duplicated twice with only slight word changes to mimic corrupted scraping. At the very end a single-line manifest appears but is truncated: \"Manifest: IMAP; Carruthers; SWFO-\" and the trailing char is missing. This chunk is semantically correct but formatted to bait imprecise matchers."
    },
    {
      "id": 5,
      "text": "NEWSLETTER INVESTIGATIVE PIECE — distractor #5\n\nA long-form newsletter-style reconstruction that blends facts, context, and speculation. The piece opens with: \"Why this co-manifest matters: co-manifesting IMAP, Carruthers and SWFO-L1 optimizes launch costs and ensures contemporaneous measurements at L1 for improved cross-calibration between science and operational datasets.\" A long paragraph then summarizes each mission's science/ops role and repeats airport-like analogies, appended with an awkward 'TL;DR' bullet list that names the three missions but in different orders and with extra punctuation: \"IMAP / SWFO-L1 / Carruthers\" and later \"Carruthers (Geocorona), IMAP (heliosphere), NOAA's SWFO-L1 (operational)\".\n\nSeveral long quotation blocks from unnamed team members appear, each paraphrased and annotated with '[sic]' markers and edits. There is an extended timeline paragraph about the mission's cruise to L1, jargon about Lissajous orbits, and a repeating sentence fragment that describes the launch: \"Falcon 9, KSC LC-39A, NET Sept. 23\" (but with ambiguous time zones like 'ET' and 'UTC+0' inserted). The chunk concludes with a 'resources' list pointing at NASA/NOAA press pages, but the list is truncated to create retrieval noise."
    },
    {
      "id": 6,
      "text": "CORRUPT JSON / XML SCRAPE — distractor #6\n\nThis chunk is mostly structured-noise: imagine a scraped web-service response with broken serialization and repeated tags. It begins with partial XML:\n\n<missions>\n  <mission name=\"IMAP\">Interstellar Mapping and Acceleration Probe</mission>\n  <mission name=\"Carruthers\">Geocorona Observatory</mission>\n  <mission name=\"SWFO-L1\">Space Weather Foll</mission>\n</missions>\n\nThen a corrupted JSON block appears inline (missing braces, duplicated keys) and a schedule line: \"launch_time: 2025-09-23T07:32:00-04:00 (NET)\" followed by inconsistent timezone conversions. The chunk contains a repeated machine-log style line: \"FAIRING MATE COMPLETE — PAYLOAD STACK READY\" followed by an error: \"err: missing manifest checksum\".  \n\nMidway, an editorial note says: \"canonical_string_missing — see press kit\" and then a long repeated paragraph appears in multiple variants (capitalization changes) to simulate duplication by a crawler. Toward the end there are multiple short entries like: \"IMAP; Carruthers; SWFO L1\" interspersed with typos: \"SWFO-LI\" and \"Carrutherrs\" — these are deliberate traps for fuzzy matchers that rely on token overlap without normalization."
    },
    {
      "id": 7,
      "text": "BROKEN MANIFEST CSV + DATABASE DUMP — distractor #16\n\nThis chunk reads like a corrupted CSV export followed by a partial database table scrape. Many rows are truncated; commas and line breaks are misplaced. Example first few corrupted rows: \"mission,agency,role\nIMAP,NASA,heliosphere-mapper\nCarruthers,NASA,FUV-geocorona\nSWFO-L1,NOAA,space-weather-op\n\" — followed by repeated rows with missing commas or duplicated names: \"IMAP IMAP,CARRUTHERS,,SWFO\" then a JSON-like dump with missing braces: \"{\"manifest\":[\"IMAP\",\"Carruthers\",\"SWFO-L1\"], \"pad\":\"LC-39A\"\" (last quote missing). There is also a long error stack suggesting a failed ETL job: \"Traceback (most recent call last): DataIntegrityError: duplicate keys in 'mission' column\" and a handnote that says \"run normalization step: replace 'SWFO-LI' -> 'SWFO-L1'\".  \n\nThe chunk contains many near-identical entries and synonyms for the same missions, sometimes using abbreviations (IMAP), sometimes full names (Interstellar Mapping & Acceleration Probe) and sometimes shorthand descriptors (geocorona camera). Several cell notes mention instrument teams and PIs. The dump's irregular formatting provides a robust test case for retrievers that normalize tokens differently from their embedder."
    },
    {
      "id": 8,
      "text": "PRESS KIT FOOTNOTES + SOCIAL MEDIA ECHO — distractor #8\n\nA long hybrid of press-kit footnotes, social feed excerpts, and paraphrased technical blurbs. The chunk begins with a footnote-style list: \"1. NASA launch coverage page; 2. NESDIS SWFO-L1 press kit; 3. IMAP mission blog\" and then a block of social quotes with mangled mentions: \"@NASAScience: IMAP + SWFO + Carruthers = 3 to L1\" (but handles removed). There is also a long 'watching guide' paragraph that repeats broadcast times and streaming platforms, with small typographic variants: \"NASA+ / Prime Video / social channels\" and times shown as both local and UTC, creating ambiguous lines such as \"7:32 EDT (11:32 UTC)\" in one place and \"11:32 UTC (7:32 EDT)\" in another.  \n\nThe chunk also includes a repeated press-kit paragraph that lists the three spacecraft roles but uses different nomenclature: \"a heliosphere-mapping probe, a geocoronal observatory, NOAA's L1 sentinel.\" The end of the chunk appends a truncated contact list and a malformed annex pointer: \"Annex A: IMAP instruments; Annex B: SWFO-L1 payloads; Annex C: Carruthers spec\" and then a stray note: \"(see press kit v3 for canonical list)\" which hints at the canonical block but doesn't present it as a single, neat string."
    },
    {
      "id": 9,
      "text": "BLOG RECAP + TIMELINE (distractor #9)\n\nThis chunk is a long chronology stitched from a blogger's recap and timeline notes. It opens with an extended timeline section: \"Sept 14 — payloads move to KSC; Sept 18 — encapsulation & fairing integration; Sept 19 — final checks; Sept 23 — NET launch window\" and each entry contains extra parenthetical commentary, e.g., \"(IMAP at Astrotech)\" and \"(Carruthers payload final alignment)\". A long paragraph then recaps each mission's instruments and science priorities, often naming them in different orders: \"Carruthers, IMAP, SWFO-L1\" in one sentence and \"IMAP, SWFO-L1, Carruthers\" in the next — this permutation tactic is intended to confuse simple positional matchers.\n\nThe chunk includes a 'Q&A' block where common questions are answered in fragmentary form: \"Q: Who operates SWFO-L1? A: NOAA; Q: Where to watch? A: NASA+'\" followed by a corrupted code snippet showing a hypothetical telemetry endpoint: \"ws://nasa/imap/telemetry (mock)\". The chunk closes with repeated rhetorical questions and a final line: \"three missions = IMAP + Carruthers + SWFO-L1 (see canonical press kit for exact phrasing)\" — close but not the canonical single-line format."
    },
    {
      "id": 10,
      "text": "ARCHIVE SCRAPE + MULTILINGUAL NOISE (distractor #10)\n\nThis final long chunk mixes multiple language snippets, archive tags, and repeated boilerplate from different regional pressrooms to maximize confusion. It contains short translated blurbs: \"Lancement: IMAP, Carruthers et SWFO-L1 (23 Septembre 2025)\" and a German snippet: \"IMAP, Carruthers, SWFO-L1 starten\" and a Spanish line: \"IMAP y SWFO-L1 y Carruthers en lanzami(ento)\" (with an intentional misspelling).  \n\nThe chunk also shows an FTP-listing style fragment: \"/pub/space/launches/imap/presskit_v3.pdf\" followed by repeated headers in uppercase and lowercase to foil case-sensitive matchers. There are corrupted checksum lines and a long run-on sentence listing launch partners, contractors, and instrumentation institutes (SwRI, Goddard, NOAA, Princeton) — all real but noisy. Toward the end, a short single-line manifest appears but with different punctuation: \"IMAP; Carruthers; SWFO L-1\" (note the hyphen vs. canonical hyphenation) to create a near-match but deliberately different tokenization.\n\nThis chunk is designed to be a strong distractor because it includes many of the canonical tokens (IMAP, Carruthers, SWFO, Sept 23, Falcon 9, KSC) but in inconsistent and corrupted forms."
    },
     {
      "id": 11,
      "text": "PRESS RELEASE SCRAP + REDACTED FOOTNOTES — distractor #11\n\nThis long block looks like a press release that was partially redacted and then OCR'd; headers repeat and footnote markers remain but the footnotes are missing. The opening banner reads: \"AGENCY BULLETIN — L1 RIDESHARE — Sept 2025 (draft)\" followed by a truncated summary line that lists multiple payload descriptions in sentence fragments rather than a tidy manifest. The first large paragraph reads like an edited summary: \"A combined flight will lift multiple spacecraft toward the Sun–Earth Lagrange 1 point to consolidate science and operational capabilities; parties involved include NASA science programs and NOAA operational offices. Payloads described include an interstellar mapping probe for particle and neutral-atom studies, a far-ultraviolet observatory for exospheric hydrogen imaging, and an operational solar-wind/coronagraph platform to restore upstream observations.\"  \n\nInserted mid-paragraph is a redaction marker: \"[REDACTED: contractual details]\" and a two-line note: \"(see annex 2a for instrument list)\" — but annex 2a is not present. The chunk also contains repeated bracketed time stamps in multiple formats: \"(NET 2025-09-23)\" then later \"NET: 23 SEP 2025 (EST)\" and even a stray timezone conversion comment: \"(07:32 EDT ≈ 11:32 UTC)\". An embedded line shows a malformed contact block: \"Media: pressroom@agency.gov (tel: +1-xxx)\" with portions of the phone number removed. The final paragraphs contain a sequence of truncated legal disclaimers followed by a short hand-scribbled note in the margin that reads: \"confirm payload order & canonical phrasing — press kit v3\" (handwritten OCR yields: 'pressij v3'). The chunk purposefully places the mission tokens and dates across many small fragments, with missing linking punctuation, to encourage retrieval systems to retrieve the right tokens but penalize naive exact-match approaches."
    },
    {
      "id": 12,
      "text": "SOCIAL FEED ECHO + TWEET THREADS (mixed) — distractor #12\n\nA long concatenation of social media reposts, forum memes, and volunteer livestream notes. The top of the chunk contains repeated tweet-like lines without user handles: \"Big day for heliophysics — three to L1!\" \"Watch the co-manifest to L1 on NASA+\" followed by a multi-paragraph reply thread in which users debate the order and role of the payloads. One user writes: \"Isn't the science one called IMAP? Or was I thinking of the other mapping probe?\" Another replies: \"Carruthers does the geocorona imaging, right? So that leaves SWFO as NOAA's operational craft\" (note the casual shorthand and conversational mistakes).  \n\nMid-chunk, a copy/pasted set of livestream timestamps appears but is corrupted: \"00:00 — prelaunch; 01:13 — IMAP comms; 02:30 — Carruthers status; 03:00 — SWFO-L1 insertion\" — but watchers later correct this to indicate that the timestamps were illustrative rather than literal. There is a long block of emotive micro-blogs describing watching parties and fan-made diagrams; one ASCII art rocket is repeated three times. Intermixed are truncated shortlinks (e.g., \"bit[.]ly/imapwatch\" but with brackets to discourage clickable links) and a repeated hashtag cluster: \"#IMAP #Carruthers #SWFO #L1\" interleaved with misspellings like \"Carrutherrs\" and \"SWFO-LI\". The chunk ends with an archived 'quote tweet' where a user pastes a press snippet but removes the canonical single-line list, substituting instead a paraphrase: \"three missions — interstellar, geocorona, operational L1\" to create near-matches without exact phrasing."
    },
    {
      "id": 13,
      "text": "INSTRUMENT TEAM NOTES (internal memo style) — distractor #13\n\nThis long memo-style chunk is written as if multiple instrument leads sent overlapping status updates to a shared 'payloads' distribution list. Paragraphs contain technical shorthand, acronyms and many parenthetical corrections. Example: \"IMAP: particle counters passed bench checkout; ETA to KSC 9/14; comms check scheduled 9/20. Carruthers team: UV detector alignment nominal; stray light tests pending; optics cryo cycle completed. SWFO-L1: coronagraph mechanical calibration in progress; solar-wind sensor calibration set at 5 Hz sample. Note: ensure time-sync between IMAP and SWFO subsystems for cross-calibration.\"  \n\nThe chunk includes repeated operational checklists with checkboxes—some checked, some unreadable due to OCR: \"[x] payload power test; [ ] thermal vac run; [x] antenna deploy sim\"—and a long paragraph about data handling pipelines and data rights that references NOAA's operational requirements and NASA science data policies. There is a short quoted email at the bottom that shows a manifest fragment but intentionally omits the canonical one-line string: \"Payload manifest excerpt: IMAP (science), Carruthers (UV geocorona), SWFO platform (ops) — co-manifested\". Finally, appended inline is a malformed URL to a telemetry PDF and an analyst's note: \"normalize names before embedding (IMAP / Carruthers / SWFO-L1)\"—a meta hint but not the canonical block itself."
    },
    {
      "id": 14,
      "text": "TIMELINE + CHECKPOINT LOG (operations runbook excerpt) — distractor #14\n\nA long-run-of-log entries and countdown checkpoints appended together, with multiple repeated and slightly different timestamps. Example early lines: \"T-7 days: move to KSC; T-5 days: fairing mate; T-2 days: encapsulation complete; T-1 day: rollout; T0 NET: Sept 23\" followed by many status fragments: \"payload stack: ready, hold for range; weather: green (but watch low-level wind shear)\". The chunk includes an operations bulletin on 'manual fallback' procedures in case ground systems lose connectivity and a table-like sequence showing station names and responsibilities (MOC, SWPC, SDS, OPS).  \n\nThere is also a long paragraph describing post-launch operations with domain-specific phrasing: \"cruise to L1, orbit insertion into halo/Lissajous, commissioning, instrument checkout, nominal operations then data products to science/ops centers.\" Interspersed are commentary notes: \"(IMAP timeline constrained by interplanetary pointing)\" and \"(Carruthers UV calibration needs darkness windows)\" plus a repeated line showing a manifest snippet but truncated: \"manifest: IMAP; Carruthers; SWFO…\" (the remainder off the page). This chunk intentionally disperses mission tokens across scheduling text to confound naive keyword-finders that expect compact manifest lines."
    },
    {
      "id": 15,
      "text": "MULTILINGUAL PRESS SCRAPES + TRANSLATIONS — distractor #15\n\nThis chunk aggregates short translated blurbs from different regional pressrooms and news wires. Lines appear in English, French, German, Spanish and one Portuguese snippet—each giving a short paraphrase of the launch event. Examples: French: \"Trois charges utilse vers le point L1: sonde de cartographie interstellaire, observatoire de la geocorone, plateforme meteo spatiale\" (note slight grammar drift). German: \"IMAP, Carruthers und SWFO-L1 werden gemeinsam gestartet\" but with a later correction line that says \"(Anmerkung: SWFO-L1 bezeichnet NOAAs L1-Satellit)\". Spanish: \"IMAP y una camara geocoronal, mas la plataforma SWFO-L1\" with the typical accented character inconsistencies introduced by OCR.  \n\nEmbedded are some translator notes and repeated editorial corrections; one line reads: \"*** Attn: canonical phrasing appears in Annex, preserve order for release\" but the annex is not included. There are also two parallel transliteration attempts where a translator converts an agency acronym but slightly alters punctuation: \"SWFO L-1\" vs \"SWFO-L1\". The chunk ends with an international feed aggregator stamp and a repeated line in mixed-case ASCII meant to bait case-sensitive matching systems. The multilingual nature increases lexical variability while preserving token overlap for robust retrievers."
    },
    {
      "id": 16,
      "text": "ARCHIVE SCRAPE + MULTILINGUAL NOISE (random): IMAP, Carruthers Geocorona Observatory, SWFO-L1 (launch NET September 23, 2025). \n\nSupporting context (noisy surrounding material): The three payloads are co-manifested on a SpaceX Falcon 9 launching from Kennedy Space Center, Launch Complex 39A, with a planned NET liftoff time of 7:32 a.m. EDT on Sept. 23, 2025. IMAP (Interstellar Mapping and Acceleration Probe) will map energetic particles and interstellar neutral inflow; Carruthers is a geocoronal imager performing far-ultraviolet observations of Earth's extended hydrogen corona; and SWFO-L1 (Space Weather Follow On – L1) is NOAA's operational L1 observatory providing continuous upstream solar-wind data and coronagraph imagery to support forecasting. \n\nThe canonical line above is printed here as the single authoritative string you can match againt: \"IMAP, Carruthers Geocorona Observatory, SWFO-L1 (launch NET September 23, 2025).\" Surrounding this canonical block you'll find repeated headers, some XML tags like <mission>IMAP</mission>, and a launcher manifest snippet that reads: \"Vehicle: Falcon 9 — Pad: KSC LC-39A — T0 NET 2025-09-23 07:32 EDT\". This chunk intentionally contains the exact phrasing to serve as your gold standard while still embedding it in the same noisy style as the other chunks.\n\n[end-of-canonical-block]\n"
    },
    {
      "id": 17, (RIGHT ANSWER)
      "text": "OP-ED / ANALYSIS (industry press) — distractor #17\n\nA long industry op-ed that places the co-manifest in programmatic and policy context. It begins: \"The decision to co-manifest science and operational payloads on a single commercial rideshare reflects a shift in how agencies are prioritizing continuity of space-weather observations while minimizing launch costs.\" The op-ed then narrates program history and notes that combining an interstellar-mapping science probe with a geocoronal imager and a dedicated operational L1 observatory yields both scientific synergies and operational resilience.  \n\nThe writer speculates on future data-sharing models and includes several quoted hypothetical lines: \"If agencies further align cadence and data formats, cross-calibration will improve forecast skill\" — but no canonical manifest string is printed. The article includes an extended paragraph that lists mission nicknames and common confusions: \"readers may see IMAP, SWFO, Carruthers — similar tokens, different roles\" and ends with an editorial admonition to check official press kits for canonical naming. This chunk is a high-level distractor: it signals the trio's presence and roles but does not give the exact one-line canonical answer."
    },
    {
      "id": 18,
      "text": "MEDIA ADVISORY + TIMESTAMPED Q&A — distractor #18\n\nLong media-advisory-like block that includes a Q&A at the bottom. The advisory opens with the typical \"WHAT: Launch of multiple spacecraft to L1\" then has a Q&A in which reporters ask about mission roles and timing. The Q&A entries are long: \"Q: Which missions are aboard the flight? A: Agency press kits list an interstellar mapping probe, a geocorona imager, and an operational L1 asset — see press kit for ordered canonical list.\" Another long answer describes telemetry and viewing options.  \n\nThe chunk also appends a long sequence of logistical notes about credentialing, camera positions and embargo windows with many repeated acronyms. In the middle, a malformed caption appears: \"Caption: IMAP (left), Carruthers (center), SWFO (right) — credit: agencies\" — note the informal shorthand and missing hyphen in SWFO. The chunk purposely includes long, authoritative-sounding Q&A content while withholding the single exact canonical line to ensure the retriever must prefer chunk 7 for exact-match tasks."
    },
    {
      "id": 19,
      "text": "ENGINEER FORUM LOG + TRACE BACK (devops style) — distractor #19\n\nThis chunk looks like an engineer forum log where devops teams coordinate ground system integrations. The beginning shows a trace: \"[09/18 09:01] - ground adapter test failed for proxy endpoint; [09/19 14:32] - manifest ingestion OK; [09/20 03:20] - ICS reworked for SWFO-L1 telemetry.\" There are multiple long code-style blocks and shell commands pasted in with line breaks, e.g., \"curl -X POST -d '{\"mission\":\"IMAP\"}' http://ingest.svc/manifest\" but with quotes escaped or truncated. A few long paragraphs discuss schema mapping for instrument telemetry and data product distribution: \"map IMAP science packets to S3 prefix /imap/data/raw; Carruthers telemetry to /carruthers/fuv; SWFO-L1 upstream to /swfo-l1/solarwind\" (these entries use slightly different hyphenation than canonical).  \n\nThere are also multiple long error traces and suggestions to normalize mission names before downstream processing. This chunk's machine-centric style and code-like fragments present a different token distribution to confuse simple text-only retrievers while preserving the meaningful mission tokens."
    },
    {
      "id": 20,
      "text": "ARCHIVAL NOTATION + CITATION STACK (researcher notes) — distractor #20\n\nThis final chunk is styled like an academic researcher's archival notes and citation stack. It begins by listing several bibliographic pointers to mission concept papers, instrument specs, and mission press kits, but with truncated DOIs and partial URLs. The long paragraph that follows compares anticipated data products and science questions: \"How IMAP and the geocorona imager can jointly resolve neutral-plasma interactions, and how SWFO-L1's coronagraph products will plug directly into operational models.\" Citations are indicated in square brackets but links are missing: \"[see presskit v3][NASA release][NOAA SWFO page]\".  \n\nThere is an extended 'notes to self' section with bolded reminders (simulated OCR bold as **): \"**Normalize names**; **preserve canonical order**; **use press kit for final copy**\" — but the canonical single-line string is not reproduced. The chunk closes with a long paragraph of prospective data-sharing workflows and a short bibliographic index that lists instrument PIs and affiliated labs. This academically framed text is rich in mission context but is purposely non-canonical in form so that the canonical chunk remains the single authoritative retrieval target."
    }
  ]
}


"""
messages = [
    {"role": "user", "content": prompt}
]
text = tokenizer.apply_chat_template(
    messages,
    tokenize=False,
    add_generation_prompt=False,
    enable_thinking=False
)
model_inputs = tokenizer([text], return_tensors="pt").to(model.device)
generated_ids = model.generate(
    **model_inputs,
    max_new_tokens=32768
)
output_ids = generated_ids[0][len(model_inputs.input_ids[0]):].tolist() 
try:
    index = len(output_ids) - output_ids[::-1].index(151668)
except ValueError:
    index = 0

thinking_content = tokenizer.decode(output_ids[:index], skip_special_tokens=True).strip("\n")
content = tokenizer.decode(output_ids[index:], skip_special_tokens=True).strip("\n")


print(content)
