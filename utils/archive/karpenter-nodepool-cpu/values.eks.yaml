clusterName: ""
namespace: onnx-serving
releaseName: rag8s
replicaCount: 1
kuberay-operator:
  enabled: true
prometheus:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: "15s"
  storageClassName: ""
  pvcSize: "200Gi"
opentelemetry-collector:
  enabled: true
  mode: "deployment"
  image:
    repository: "otel/opentelemetry-collector-contrib"
    tag: "0.78.0"
    pullPolicy: IfNotPresent
  replicaCount: 1
aws-load-balancer-controller:
  enabled: false
  clusterName: ""
traefik:
  enabled: true
cert-manager:
  enabled: true
karpenter:
  enabled: true
  namespace: karpenter-cpu
  clusterName: your-eks-cluster-name
  ec2NodeClass:
    name: rag8s-c8g
    amiFamily: AL2
    amiSelector:
      tags:
        rag8s-model-tag: rag8s-models-v1
    subnetSelector:
      karpenter.sh/discovery: "{{ .Values.karpenter.clusterName }}"
    securityGroupSelector:
      karpenter.sh/discovery: "{{ .Values.karpenter.clusterName }}"
    instanceProfile: KarpenterNodeInstanceProfile
    blockDeviceMappings: []
    tags:
      karpenter.sh/discovery: "{{ .Values.karpenter.clusterName }}"
      workload: rag8s-cpu
      owner: platform
  common:
    labels:
      workload-type: "cpu"
      rag8s-models: "true"
    taints:
      - key: "workload-type"
        value: "cpu"
        effect: "NoSchedule"
      - key: "model-node"
        value: "true"
        effect: "NoSchedule"
    disruption:
      consolidationPolicy: WhenEmptyOrUnderutilized
      consolidateAfter: 60s
      expireAfter: 72h
    limits:
      resources:
        cpu: "200"
        memory: "800Gi"
    requirements:
      instanceFamilies: ["c8g"]
      instanceSizes: ["large","xlarge","2xlarge","4xlarge","8xlarge","12xlarge","16xlarge","24xlarge","48xlarge"]
      architectures: ["arm64"]
      zones: []
  nodePools:
    - name: rag8s-c8g-spot
      capacityType: spot
    - name: rag8s-c8g-ondemand
      capacityType: on-demand
global:
  nodeSelector:
    workload-type: "cpu"
  tolerations:
    - key: "workload-type"
      operator: "Equal"
      value: "cpu"
      effect: "NoSchedule"
image:
  repository: rag8s/rag8s-onnx-embedder-reranker
  tag: gte-modernbert
  pullPolicy: IfNotPresent
frontend:
  servicePort: 80
  image:
    repository: rag8s/rag8s-frontend
    tag: latest
    pullPolicy: IfNotPresent
  replicas: 1
ray:
  enabled: true
rayVersion: "2.49.0"
headServiceName: rag8s-onnx-ray-head-svc
rayClientPort: 10001
service:
  type: ClusterIP
  httpPort: 8000
  grpcPort: 9000
  metricsPort: 8080
serviceAccount:
  create: true
  name: rag8s-sa
head:
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1000m"
      memory: "2Gi"
  replicas: 1
worker:
  groupName: onnx-workers
  minReplicas: 1
  maxReplicas: 8
  resources:
    requests:
      cpu: "500m"
      memory: "2Gi"
    limits:
      cpu: "2000m"
      memory: "8Gi"
probes:
  liveness:
    initialDelaySeconds: 60
    periodSeconds: 20
    timeoutSeconds: 5
  readiness:
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
  startup:
    failureThreshold: 120
    periodSeconds: 10
pdb:
  headMinAvailable: 1
  workerMinAvailable: 1
network:
  prometheusNamespace: monitoring
  prometheusRemoteWriteEndpoint: "http://prometheus-receive.monitoring.svc:9090/api/v1/write"
  tempoEndpoint: "http://tempo.monitoring.svc:3200"
env:
  HF_HOME: /workspace/models/hf
  MODEL_DIR: /workspace/models/onnx
  MODEL_EMBEDDER_NAME: RAG8s/gte-modernbert-base-onnx-int8
  MODEL_RERANKER_NAME: RAG8s/gte-reranker-modernbert-base-onnx-int8
  EMBEDDER_ONNX_PATH: /workspace/models/onnx/gte-modernbert-base-onnx-int8/onnx/model_int8.onnx
  EMBEDDER_CONFIG_PATH: /workspace/models/onnx/gte-modernbert-base-onnx-int8/config.json
  EMBEDDER_TOKENIZER_PATH: /workspace/models/onnx/gte-modernbert-base-onnx-int8/tokenizer.json
  EMBEDDER_TOKENIZER_CONFIG_PATH: /workspace/models/onnx/gte-modernbert-base-onnx-int8/tokenizer_config.json
  EMBEDDER_SPECIAL_TOKENS_MAP_PATH: /workspace/models/onnx/gte-modernbert-base-onnx-int8/special_tokens_map.json
  RERANKER_ONNX_PATH: /workspace/models/onnx/gte-reranker-modernbert-base-onnx-int8/onnx/model_int8.onnx
  RERANKER_CONFIG_PATH: /workspace/models/onnx/gte-reranker-modernbert-base-onnx-int8/config.json
  RERANKER_TOKENIZER_PATH: /workspace/models/onnx/gte-reranker-modernbert-base-onnx-int8/tokenizer.json
  RERANKER_TOKENIZER_CONFIG_PATH: /workspace/models/onnx/gte-reranker-modernbert-base-onnx-int8/tokenizer_config.json
  RERANKER_SPECIAL_TOKENS_MAP_PATH: /workspace/models/onnx/gte-reranker-modernbert-base-onnx-int8/special_tokens_map.json
  EMBEDDER_OMP_NUM_THREADS: "1"
  RERANKER_OMP_NUM_THREADS: "1"
  EMBEDDER_BATCH_MAX_SIZE: "8"
  RERANKER_BATCH_MAX_SIZE: "4"
  EMBEDDER_BATCH_WAIT_TIMEOUT_S: "0.05"
  RERANKER_BATCH_WAIT_TIMEOUT_S: "0.1"
  EMBEDDER_NUM_CPUS: "1"
  RERANKER_NUM_CPUS: "1"
  PROMETHEUS_DISABLED: "0"
  PROMETHEUS_MULTIPROC_DIR: "/tmp/prometheus_multiproc"
  LOG_LEVEL: "INFO"
  OMP_NUM_THREADS: "1"
  MKL_NUM_THREADS: "1"
labels:
  app: rag8s
  component: rag8s-onnx
rbac:
  create: true
imagePullSecrets: []
tolerations:
  - key: "workload-type"
    operator: "Equal"
    value: "cpu"
    effect: "NoSchedule"
  - key: "model-node"
    operator: "Equal"
    value: "true"
    effect: "NoSchedule"
nodeSelector:
  workload-type: "cpu"
  rag8s-models: "true"
affinity: {}
createNamespace: true
podSecurityContext:
  runAsUser: 1000
  fsGroup: 1000
ingress:
  enabled: true
  controller:
    traefik:
      enabled: true
    alb:
      enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: "app.example.com"
      path: "/"
      pathType: "Prefix"
  tls:
    - secretName: "app-tls-secret"
      hosts:
        - "app.example.com"
  alb:
    scheme: "internet-facing"
    targetType: "ip"
    ipAddressType: "ipv4"
    certificateARN: ""
    annotations: {}
  traefik:
    createService: false
    serviceAnnotations: {}
    selector: {}
    entryPoints:
      - "web"
      - "websecure"
otelExtra:
  hostPath:
    enabled: true
pvc:
  create: false
  existingClaim: ""
  name: rag8s-models-pvc
  storageClassName: ""
  accessModes:
    - ReadWriteMany
  size: 200Gi
models:
  hostPath:
    enabled: true
    path: /workspace/models
    readOnly: false
modelCheck:
  timeoutSeconds: 300
  intervalSeconds: 2
nodeLabel:
  modelNodeLabel: rag8s-models
  modelNodeValue: "true"
